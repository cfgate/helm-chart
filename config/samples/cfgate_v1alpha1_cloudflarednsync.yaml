# Example CloudflareDNSSync resource
apiVersion: cfgate.io/v1alpha1
kind: CloudflareDNSSync
metadata:
  name: production-dns
  namespace: cloudflare-system
spec:
  # Reference to the CloudflareTunnel
  tunnelRef:
    name: production-tunnel
    namespace: cloudflare-system

  # Zones to manage
  zones:
    - name: example.com
    - name: api.example.org

  # Hostname Sources
  source:
    # Watch Gateway API routes
    gatewayRoutes:
      enabled: true
      annotationFilter: "cfgate.io/dns-sync=enabled"

    # Explicit hostnames
    explicit:
      - hostname: legacy.example.com
        target: "{{ .TunnelDomain }}"
        proxied: true
        ttl: auto

  # Default record settings
  defaults:
    proxied: true
    ttl: auto

  # Ownership tracking
  ownership:
    txtRecord:
      enabled: true
      prefix: "_cfgate"
    comment:
      enabled: false

  # Cleanup policy
  cleanupPolicy:
    deleteOnRouteRemoval: true
    deleteOnResourceRemoval: true
    onlyManaged: true
